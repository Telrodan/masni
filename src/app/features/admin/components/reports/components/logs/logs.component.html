<h1 class="p-card-title my-5">Logok</h1>

<p-table
  #table
  *ngIf="logsData$ | async as logsData"
  styleClass="p-datatable-gridlines min-h-screen shadow-2"
  [value]="logsData.logs"
  [paginator]="true"
  [rows]="10"
  [rowsPerPageOptions]="[10, 25, 50]">
  <ng-template pTemplate="header">
    <tr>
      <th></th>

      <th>Modul</th>

      <th class="w-10rem">Felhasználó</th>

      <th>Üzenet</th>

      <th class="w-14rem">Dátum</th>
    </tr>

    <tr>
      <th></th>

      <th class="max-w-12rem w-12rem">
        <p-columnFilter field="meta.module" matchMode="in" [showMenu]="false">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <p-multiSelect
              [ngModel]="value"
              [options]="logsData.modules"
              placeholder="Mind"
              (onChange)="filter($event.value)">
              <ng-template let-option pTemplate="item">
                <span>
                  {{ option.value }}
                </span>
              </ng-template>
            </p-multiSelect>
          </ng-template>
        </p-columnFilter>
      </th>

      <th class="max-w-12rem w-12rem">
        <p-columnFilter field="meta.user" matchMode="in" [showMenu]="false">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <p-multiSelect
              [ngModel]="value"
              [options]="logsData.userEmails"
              placeholder="Mind"
              (onChange)="filter($event.value)">
              <ng-template let-option pTemplate="item">
                <span>
                  {{ option.value }}
                </span>
              </ng-template>
            </p-multiSelect>
          </ng-template>
        </p-columnFilter>
      </th>

      <th></th>

      <th></th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-log>
    <tr>
      <td class="vertical-align-middle">
        <i
          *ngIf="log.level === 'info'"
          class="pi pi-info-circle text-xl text-blue-500"></i>

        <i
          *ngIf="log.level === 'warn'"
          class="pi pi-exclamation-triangle text-xl text-orange-500"></i>

        <i
          *ngIf="log.level === 'error'"
          class="pi pi-times-circle text-xl text-red-500"></i>
      </td>

      <td class="font-bold">
        {{ log.meta?.module }}
      </td>

      <td>
        <span class="vertical-align-middle">{{ log.meta?.user }}</span>
      </td>

      <td>
        <span class="vertical-align-middle">{{ log.message }}</span>
      </td>

      <td>
        <span class="vertical-align-middle text-primary">
          {{ log.timestamp | date : 'medium' }}
        </span>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="5" class="text-center">Nem található logok</td>
    </tr>
  </ng-template>
</p-table>
