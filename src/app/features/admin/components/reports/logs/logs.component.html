<div class="nyk-logs-header">Eseménynapló</div>

<p-table
    #table
    *ngIf="logs$ | async as logs"
    styleClass="p-datatable-gridlines"
    [globalFilterFields]="['meta.user.email', 'meta.module', 'message']"
    [value]="logs"
    [paginator]="true"
    [rows]="50"
    [rowsPerPageOptions]="[50, 100, 200]">
    <ng-template pTemplate="caption">
        <input
            pInputText
            pTooltip="Kereshető mezők:
                Modul
                Felhasználó
                Üzenet
            "
            tooltipPosition="bottom"
            class="w-full"
            type="text"
            (input)="applyTableGlobalFilter($event, 'contains', table)"
            placeholder="Keresés" />
    </ng-template>

    <ng-template pTemplate="header">
        <tr>
            <th></th>

            <th>Modul</th>

            <th class="w-10rem">Felhasználó</th>

            <th>Üzenet</th>

            <th class="w-14rem" pSortableColumn="timestamp">
                <div class="flex">
                    Dátum
                    <p-sortIcon field="timestamp"></p-sortIcon>
                </div>
            </th>

            <th></th>
        </tr>
    </ng-template>

    <ng-template pTemplate="body" let-log>
        <tr>
            <td class="vertical-align-middle w-3rem">
                <p-badge [severity]="getBadgeSeverity(log)" [styleClass]="getBadgeIcon(log)">
                </p-badge>
            </td>

            <td class="text-primary w-7rem">
                {{ log.meta?.module }}
            </td>

            <td>
                <span class="text-cyan-600">{{ log.meta?.user?.email }}</span>
            </td>

            <td>
                <span class="text-black-alpha-90 font-medium">{{ log.message }}</span>
            </td>

            <td>
                <span class="text-black-alpha-90">
                    {{ log.timestamp | date : 'medium' }}
                </span>
            </td>

            <td class="text-center">
                <p-button
                    label="Részletek"
                    [raised]="true"
                    severity="help"
                    (click)="onDetailedLog(log)" />
            </td>
        </tr>
    </ng-template>
</p-table>
