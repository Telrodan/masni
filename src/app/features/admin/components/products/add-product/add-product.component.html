<div class="nyk-add-product-header">Termék hozzáadás</div>

<form class="nyk-add-product-form" [formGroup]="addProductForm">
    <div class="form-group">
        <label for="name"> Termék neve </label>

        <input id="name" type="text" formControlName="name" pInputText />
    </div>

    <div class="form-group">
        <label for="categoryId"> Termék kategória </label>

        <p-dropdown
            id="category"
            formControlName="category"
            [options]="productSubCategories$ | async"
            placeholder="Válassz egy kategóriát"
            optionValue="id"
            optionLabel="name"
            styleClass="w-full">
        </p-dropdown>
    </div>

    <div class="form-group">
        <label for="shortDescription"> Termék rövid leírás </label>

        <input id="shortDescription" formControlName="shortDescription" type="text" pInputText />
    </div>

    <div class="form-group">
        <label for="description"> Termék leírás </label>

        <p-editor formControlName="description" [style]="{ height: '320px' }"></p-editor>
    </div>

    <div class="form-group">
        <label for="price"> Termék ára </label>

        <p-inputNumber
            [showButtons]="true"
            inputId="price"
            formControlName="price"
            mode="currency"
            currency="HUF"
            styleClass="w-full"
            [min]="0" />
    </div>

    <div class="form-group">
        <label for="discountedPrice"> Termék akciós ára </label>

        <p-inputNumber
            [showButtons]="true"
            inputId="discountedPrice"
            formControlName="discountedPrice"
            mode="currency"
            currency="HUF"
            styleClass="w-full"
            [min]="0" />
    </div>

    <div class="form-group">
        <label for="stock"> Készleten </label>

        <p-inputNumber
            [showButtons]="true"
            inputId="stock"
            formControlName="stock"
            mode="decimal"
            styleClass="w-full"
            [min]="0" />
    </div>

    <div class="form-group">
        <label for="selectedQuestion"> Kérdések </label>

        <div class="nyk-add-product-questions-wrapper">
            <p-dropdown
                id="selectedQuestion"
                formControlName="selectedQuestion"
                [options]="questions$ | async"
                placeholder="Válassz egy kérdést"
                optionValue="id"
                optionLabel="name">
            </p-dropdown>

            <p-button
                icon="pi pi-plus"
                styleClass="p-button-success ml-2"
                pTooltip="Kérdés hozzáadás"
                tooltipPosition="bottom"
                (click)="onAddQuestion(addProductForm.get('selectedQuestion').value)"></p-button>
        </div>
    </div>

    <div *ngIf="selectedQuestions.length" class="form-group">
        <label>Választott kérdések</label>

        <div
            class="nyk-add-product-option-wrapper mb-2"
            *ngFor="let question of selectedQuestions; let i = index">
            <p>{{ i + 1 }}. {{ question.name }}</p>

            <p-button
                icon="pi pi-times"
                styleClass="p-button-danger"
                (click)="onDeleteQuestion(question.id, i)">
            </p-button>
        </div>
    </div>

    <div class="form-group">
        <label> Egyedi termék </label>

        <p-inputSwitch formControlName="isCustom"></p-inputSwitch>
    </div>
    <!-- 
    <div *ngIf="addProductForm.value.isCustom" class="form-group">
        <label for="inspirationCategoryId"> Inspiráció kategória </label>

        <p-dropdown
            id="inspirationCategoryId"
            formControlName="inspirationCategoryId"
            [options]="inspirationCategories$ | async"
            placeholder="Válassz egy kategóriát"
            optionValue="id"
            optionLabel="name"
            styleClass="w-full">
        </p-dropdown>
    </div> -->

    <div class="form-group">
        <label>Babaruha</label>

        <p-inputSwitch formControlName="isDollDress"></p-inputSwitch>
    </div>

    <div class="form-group">
        <label> Öltöztethető </label>

        <p-inputSwitch formControlName="isDressable"></p-inputSwitch>
    </div>

    <div class="form-group">
        <label> Kiemelt termék </label>

        <p-inputSwitch formControlName="isFeatured"></p-inputSwitch>
    </div>

    <div class="form-group">
        <label for="isNameEmbroideryAvailable"> Név hímzés elérhető </label>

        <p-inputSwitch formControlName="isNameEmbroideryAvailable"></p-inputSwitch>
    </div>

    <div class="form-group">
        <label for="images"> Termék képek (az első kép lesz mindig a nagy kép) </label>

        <p-button
            *ngIf="imagesPreview.length === 0; else clearImagesButton"
            [raised]="true"
            icon="pi pi-image"
            styleClass="p-button p-button-secondary"
            (click)="imagesPicker.click()">
        </p-button>

        <ng-template #clearImagesButton>
            <p-button
                [raised]="true"
                icon="pi pi-times"
                severity="danger"
                pTooltip="Kép törlése"
                tooltipPosition="bottom"
                (click)="onImageClear(imagesPicker)">
            </p-button>
        </ng-template>

        <input
            id="imagesPicker"
            multiple
            type="file"
            class="hidden"
            #imagesPicker
            (change)="onImagePicked($event)" />

        <img
            *ngIf="!imagesPreview.length"
            class="mt-2 image-preview border-round"
            src="../../../../../../assets/images/no-image.png"
            alt="Termék" />

        <div
            cdkDropList
            cdkDropListOrientation="horizontal"
            class="nyk-add-product-images-container"
            (cdkDropListDropped)="drop($event)">
            <div *ngFor="let image of imagesPreview" class="nyk-add-product-image" cdkDrag>
                <img [src]="image" />
                <img
                    *cdkDragPreview
                    class="nyk-add-product-images-container-preview"
                    [src]="image" />
            </div>
        </div>
    </div>

    <p-button
        [raised]="true"
        label="Hozzáadás"
        styleClass="p-button w-full"
        [disabled]="!addProductForm.valid"
        (click)="onAddProduct()">
    </p-button>
</form>
